# smzdm-watcher
 
从smzdm上抓取感兴趣的特价信息并且微信发送通知

## 功能

* 定时抓取相关关键词的优惠信息

* 发现新的优惠发送微信通知（这里使用微信企业号开发平台）

*已经发送过的信息不再发送第二次

## 未解决的问题

上文实验通过浏览器获取cookie后手动处理Header才能获取页面文本。直接通过httpclient访问会返回HTTP 521错误。但该错误同时会返回一段代码

```javascript

var x="https@Apr@captcha@Path@location@String@window@challenge@06@cd@e@_phantom@a@4@match@Expires@setTimeout@try@length@16@x@join@return@substr@01@addEventListener@1459902268@cookie@Wed@h@24@f@__jsl_clearance@r@28@document@div@dc@i@href@innerHTML@reverse@function@charAt@1500@5@0@l@while@if@false@catch@eval@for@toLowerCase@createElement@firstChild@var@fromCharCode@GMT@replace@2@__phantomas@412@DOMContentLoaded@else@attachEvent@onreadystatechange".replace(/@*$/,"").split("@"),

y="1r 1h=1c(){1i(7.c||7.21){};1r a,17='12=r.22|1g|';1r 11=[1c(l){n 1m('6.1s('+l+')')},(1c(){1r u=15.1p('16');u.1a='<d 19=\\'/\\'>l</d>';u=u.1q.19;1r 13=u.f(/1?:\\/\\//)[1g];u=u.o(13.j).1o();n 1c(l){1n(1r 18=1g;18<l.j;18++){l[18]=u.1d(l[18])};n l.m('')}})()];a=[[(-~!{}+[]+[])+(e+[])],[(-~!{}+[]+[])+(-~!{}+[]+[])+([-~!{}+20]*(-~!{}+20)+[[], !![]][~~{}]),[(-~{}|((+!![])<<(+!![])))]+[-~~~![]-~~~![]-~((-~-~[])*[-~-~[]])],(-~-~[]-~!{}-~-~[]+[])+[(+[])],[(+!![])-~-~[]-~!{}-~-~[]]+[(+!![])-~-~[]-~!{}-~-~[]],(-~!{}+[]+[])+[(+[])]+(-~-~[]-~!{}-~-~[]+[]),[-~~~![]-~~~![]-~((-~-~[])*[-~-~[]])]+[(+!![])-~-~[]-~!{}-~-~[]],(-~!{}+[]+[])+[(+[])]+(((+!![])<<(+!![]))+[[]][(+[])]),[(-~{}|((+!![])<<(+!![])))]+[-~~~![]-~~~![]-~((-~-~[])*[-~-~[]])],(-~-~[]-~!{}-~-~[]+[])+[(+[])],[-~~~![]-~~~![]-~((-~-~[])*[-~-~[]])]+[(+[])],[((+!![])<<(+!![]))-~[1f]]+(-~!{}+[]+[]),[(+!![])-~-~[]-~!{}-~-~[]]+[((+!![])<<(+!![]))-~[1f]],[((+!![])<<(+!![]))-~[1f]]+(-~!{}+[]+[]),(-~!{}+[]+[])+[(+[])]+[-~~~![]-~~~![]-~((-~-~[])*[-~-~[]])],(-~-~[]-~!{}-~-~[]+[])+[-~~~![]-~~~![]-~((-~-~[])*[-~-~[]])]],[(-~!{}+[]+[])+(e+[]),(-~!{}+[]+[])+[(+[])]],[[((+!![])<<(+!![]))-~[1f]]+[(-~{}|((+!![])<<(+!![])))],[(+!![])-~-~[]-~!{}-~-~[]]+[((+!![])<<(+!![]))-~[1f]],[((+!![])<<(+!![]))-~[1f]]+(e+[]),(-~!{}+[]+[])+[(+[])]+[(-~{}|((+!![])<<(+!![])))],[((+!![])<<(+!![]))-~[1f]]+[(+[])]],[(e+[])],[[((+!![])<<(+!![]))-~[1f]]+(((+!![])<<(+!![]))+[[]][(+[])])],[(-~!{}+[]+[])],[[(+!![])-~-~[]-~!{}-~-~[]]+[((+!![])<<(+!![]))-~[1f]],[-~~~![]-~~~![]-~((-~-~[])*[-~-~[]])]+[-~~~![]-~~~![]-~((-~-~[])*[-~-~[]])],(-~!{}+[]+[])+(-~!{}+[]+[])+[(-~{}|((+!![])<<(+!![])))],(-~!{}+[]+[])+[(+[])]+(((+!![])<<(+!![]))+[[]][(+[])]),[-~~~![]-~~~![]-~((-~-~[])*[-~-~[]])]+[-~~~![]-~~~![]-~((-~-~[])*[-~-~[]])],[(-~{}|((+!![])<<(+!![])))]+[-~~~![]-~~~![]-~((-~-~[])*[-~-~[]])],(-~-~[]-~!{}-~-~[]+[])+(-~!{}+[]+[]),[(+!![])-~-~[]-~!{}-~-~[]]+[((+!![])<<(+!![]))-~[1f]]]];1n(1r 18=1g;18<a.j;18++){a[18]=11.1b()[[(+[])]](a[18])};a=a.m('');17+=a;h('5.19=5.19.1u(/[\\?|&]3-8/,\\'\\')',1e);15.s=(17+';g=t, 9-2-k p:10:14 1t;4=/;');};1j((1c(){i{n !!7.q;}1l(b){n 1k;}})()){15.q('23',1h,1k);}24{15.25('26',1h);}",

z=0,

f=function(x,y){
    var a=0,b=0,c=0;
    y=y||99;
    while((a=x.shift())&&(b=a.charCodeAt(0)-77.5))
        c=(Math.abs(b)<13?(b+48.5):parseInt(a,36))+y*c;
},

g=y.match(/\b\w+\b/g).sort(function(x,y){return f(x)-f(y)}).pop();

while(f(g,++z)-x.length){};

eval(y.replace(/\b\w+\b/g, function(y){return x[f(y,z)-1]}));

```

这段代码会在浏览器中增加cookie类似：

```javascript
"__jsluid=866575b22f70d10e50d933c88f9d3411;__jsl_clearance=1459854000.308|0|bogaNWw49Alg1AzlYoj1FX2YNnA%3D;"

```

在下次http请求时候应该带上这个cookie才能正常获取到页面的信息。

如果能用java实现这段代码，并生成cookie就可以真正实现稳定抓取了。
